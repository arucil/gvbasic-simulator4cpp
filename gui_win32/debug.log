0 
3 graph
3 i=3
3 for i to 20 step 1
3 line i, (28 - i), i, (52 + i), 
3 next 
4 i=23
4 for i to 63 step 1
4 line i, 8, i, 28, 
4 line i, 52, i, 72, 
4 next 
5 i=1
5 for i to 30 step 1
5 line (i + 65), (i + 8), (i + 65), (i + 40), 
5 line (128 - i), (i + 8), (128 - i), (i + 40), 
5 next 
6 locate 15, 5
6 print "STUDI"; 
6 locate 17, 4
6 print "SOFT", 
6 poke 803, 79
6 print , 
6 k$=inkey$
7 ah=100
7 dx(3, )=40
7 dy(3, )=16
7 dpx(3, )=1
7 dh(3, )=5
7 graph
7 goto 2100
8 locate 5, 3
8 print "Now Loading...", 
10 text
10 print "1792年，特瓦尼亚…", 
10 k$=inkey$
10 cls
10 w$="(RICHTER):"
10 gosub 2093
10 text
11 d$="(DRACULA):"
11 print w$, "一切该结束了。", 
11 k$=inkey$
11 cls
11 print d$, "……", 
11 k$=inkey$
11 cls
12 cls
12 print w$, "离开吧你是不属于这个世界的。", 
12 k$=inkey$
12 cls
12 print d$, 
13 print "我单凭自己的力量是无法复活的。", 
13 k$=inkey$
13 cls
13 print d$, "贪婪的人类使我复活的", 
14 k$=inkey$
14 cls
14 print w$, "人类能够团结在一起，为了理想而共同进步。", 
15 k$=inkey$
15 cls
15 print d$, "人类需要统治", 
16 k$=inkey$
16 cls
16 print w$, "只有善良仁慈的人才具有统率他们的资格。", 
17 k$=inkey$
17 cls
17 print d$, "多说无益", "究竟谁是正确的，等你死了之后就会知道了。", 
20 k$=inkey$
20 ax=20
20 ay=50
20 bp=1
20 v=4
20 graph
20 open "CVMAP" for append as #0 len=-1
30 cls
30 dim map(19, 9, )
30 mm=1
40 locate 5, 3
40 print "Now Loading...", 
45 mn=((mm - 1) * 300)
45 fseek #0, mn
50 iy=0
50 for iy to 9 step 1
50 ix=0
50 for ix to 19 step 1
60 map(ix, iy, )=[35](1)
60 next 
60 next 
61 up=[35](1)
61 do=[35](1)
61 le=[35](1)
62 ri=[35](1)
62 dd(1, )=[35](1)
62 i=1
62 for i to dd(1, ) step 1
63 dh(i, )=[35](1)
63 dx(i, )=[35](1)
63 dy(i, )=[35](1)
64 dpx(i, )=([35](1) - 1)
64 next 
70 cls
80 iy=0
80 for iy to 9 step 1
80 ix=0
80 for ix to 19 step 1
90 if (map(ix, iy, ) = 1) then
	box (ix * 8), (iy * 8), ((ix * 8) + 7), ((iy * 8) + 7), 1, 
	box ((ix * 8) + 1), ((iy * 8) + 2), ((ix * 8) + 6), ((iy * 8) + 5), 0, 0
endif
100 next 
100 next 
100 box 1, 1, 30, 7, 1, 0
100 box 1, 1, 30, 7, , 
100 box 3, 3, 28, 5, 1, 
110 cd=ad
110 cx=ax
110 cy=ay
110 cp=bp
110 box (ax - 1), (ay - 4), (ax + 1), (ay - 2), 1, 
112 box 3, 3, 28, 5, 1, 0
112 box 3, 3, (3 + ((ah / 100) * 25)), 5, 1, 
115 if (ad > 0) then
	line (ax + (bp * 3)), (ay - 1), (ax + (bp * 10)), (ay - 1), 
	ad=(ad - 1)
endif
120 line ((ax - 2) + bp), ay, ((ax + 2) + bp), ay, 
120 line (ax - 2), (ay + 6), ax, (ay + 1), 
120 line (ax + 2), (ay + 6), ax, (ay + 1), 
125 line (ax - bp), ay, (ax - (bp * 2)), (ay + 6), 
125 goto 350
130 sleep 60
130 if ([25](191) 317 127) then
	goto 180
endif
135 bp=-1
135 bx=(ax - v)
135 by=ay
135 gosub 140
135 if (pp = 0) then
	ax=bx
	goto 175
endif
136 ax=(((px(1, ) + 1) * 8) + 4)
136 goto 180
140 px(1, )=[11](((bx - 3) / 8))
140 px(2, )=[11](((bx + 3) / 8))
140 py(1, )=[11](((by - 4) / 8))
140 py(2, )=[11](((by + 6) / 8))
140 pp=0
150 py(3, )=[11]((by / 8))
160 ix=1
160 for ix to 2 step 1
160 iy=1
160 for iy to 3 step 1
160 pp=(pp + map(px(ix, ), py(iy, ), ))
170 next 
170 next 
170 return
175 if ((ax - 3) < 8) then
	mm=le
	ax=148
	goto 40
endif
180 if ([25](191) 317 247) then
	goto 190
endif
181 bx=(ax + v)
181 by=ay
181 bp=1
181 gosub 140
182 if (pp = 0) then
	ax=bx
	if (ax > 148) then
		ax=11
		mm=ri
		goto 40
	endif
endif
183 if (pp > 0) then
	ax=((px(2, ) * 8) - 5)
endif
190 if ([25](199) < 128) then
	goto 230
endif
200 k=([25](199) - 128)
200 poke 199, 0
205 if (k = 14) then
	v=4
endif
210 if ((k = 20) 278 (ab = 1)) then
	ac=7
endif
215 if (k = 21) then
	ac=0
endif
220 if (((k = 13) 278 (ad = 0)) 278 (map([11](((ax + (bp * 10)) / 8)), [11](((ay - 1) / 8)), ) = 0)) then
	ad=6
endif
230 if (ac > 0) then
	goto 240
else
	goto 260
endif
240 ac=(ac - 1)
240 bx=ax
240 by=(ay - 3)
240 gosub 140
250 if (pp = 0) then
	ay=by
	if (((ay - 4) < 8) 278 (up > 0)) then
		ay=65
		mm=up
		goto 40
	else
		if (ay < 12) then
			ay=(ay + 3)
		endif
	endif
endif
255 if (pp > 0) then
	ay=(((py(1, ) + 1) * 8) + 4)
endif
260 by=(ay + 3)
260 bx=ax
260 px(1, )=[11](((bx - 3) / 8))
260 py=[11](((by + 6) / 8))
260 px(2, )=[11](((bx + 3) / 8))
260 pp=0
270 i=1
270 for i to 2 step 1
270 pp=(pp + map(px(i, ), py, ))
270 next 
280 if ((pp = 0) 278 (ac = 0)) then
	ay=by
	if (ay > 65) then
		if (do > 0) then
			mm=do
			ay=12
			goto 40
		else
			ay=(ay - 3)
		endif
	endif
endif
283 if (pp > 0) then
	ay=((py * 8) - 7)
endif
285 if (pp = 0) then
	ab=0
else
	ab=1
endif
290 i=0
290 for i to 0 step 1
290 next 
310 box (cx - 3), (cy - 4), (cx + 3), (cy + 6), 1, 0
320 if (cd > 0) then
	line (cx + (cp * 10)), (cy - 1), (cx + (cp * 3)), (cy - 1), 0
endif
321 if (dd(1, ) = 0) then
	goto 330
endif
322 i=1
322 for i to dd(1, ) step 1
322 if (dh(i, ) > 0) then
	box (ex(i, ) - 2), (ey(i, ) - 3), (ex(i, ) + 2), (ey(i, ) + 3), 1, 0
endif
323 next 
330 goto 110
350 if (dd(1, ) = 0) then
	goto 130
endif
360 j=1
360 for j to dd(1, ) step 1
370 if (dh(j, ) = 0) then
	goto 550
endif
380 box (dx(j, ) - 2), (dy(j, ) - 1), (dx(j, ) + 2), (dy(j, ) + 1), 1, 
380 ex(j, )=dx(j, )
380 ey(j, )=dy(j, )
390 line (dx(j, ) - 2), (dy(j, ) - 3), (dx(j, ) - 2), (dy(j, ) + 3), 2
400 line (dx(j, ) + 2), (dy(j, ) - 3), (dx(j, ) + 2), (dy(j, ) + 3), 2
400 draw (dx(j, ) - 2), dy(j, ), , 
400 draw (dx(j, ) + 2), dy(j, ), , 
410 if (([1]((dx(j, ) - ax)) < 7) 278 ([1]((dy(j, ) - ay)) < 9)) then
	ah=(ah - 5)
	if (ah > 0) then
		goto 420
	else
		goto 415
	endif
else
	goto 420
endif
415 i=0
415 for i to 500 step 1
415 circle ([18](1) * 160), ([18](1) * 80), 5, 1, 
415 sleep 1
415 next 
415 locate 6, 3
415 print "GAME  OVER", 
416 end
420 if (((ad > 0) 278 ([1]((dx(j, ) - (ax + (5 * bp)))) < 7)) 278 ([1]((dy(j, ) - ay)) < 5)) then
	dh(j, )=(dh(j, ) - 1)
	goto 430
else
	goto 490
endif
430 if (dh(j, ) = 0) then
	box (dx(j, ) - 2), (dy(j, ) - 3), (dx(j, ) + 2), (dy(j, ) + 3), 1, 0
	s=(s + 7)
endif
431 goto 490
440 
450 px(1, )=[11](((bx - 2) / 8))
450 px(2, )=[11](((bx + 2) / 8))
450 py(1, )=[11](((by - 3) / 8))
450 py(2, )=[11](((by + 3) / 8))
450 pp=0
460 ix=1
460 for ix to 2 step 1
460 iy=1
460 for iy to 2 step 1
470 pp=(map(px(ix, ), py(iy, ), ) + pp)
470 next 
470 next 
480 return
490 bx=(dx(j, ) + dpx(j, ))
490 by=dy(j, )
500 gosub 450
500 if (pp = 0) then
	dx(j, )=bx
else
	dpx(j, )=[30](dpx(j, ))
endif
510 if (dpp(j, ) > 0) then
	goto 540
endif
520 bx=dx(j, )
520 by=(dy(j, ) + 3)
520 gosub 450
530 if (pp = 0) then
	dy(j, )=by
	goto 550
else
	dpp(j, )=7
endif
540 bx=dx(j, )
540 by=(dy(j, ) - 3)
540 gosub 450
540 dpp(j, )=(dpp(j, ) - 1)
545 if (pp = 0) then
	dy(j, )=by
endif
550 next j
560 goto 130
2090 box 1, 0, 159, 79, , 
2090 box 2, 1, 158, 78, , 
2090 box 4, 3, 156, 76, , 
2091 return
2093 graph
2093 locate 5, 3
2093 print "Now Loading...", 
2093 open "CVMAP" for append as #0 len=-1
2096 fseek #0, 1800
2096 fread #06592, 1600
2096 close #0
2097 box 1, 0, 159, 79, , 
2097 box 2, 1, 158, 78, 0, 0
2097 box 3, 2, 157, 77, , 
2097 k$=inkey$
2097 inkey
2099 return
2100 gosub 9000
2100 locate 12, 2
2100 print "开始游戏", 
2100 locate 12, 3
2100 print "制作说明", 
2101 locate 12, 4
2101 box 70, 14, 154, 65, , 
2101 box 69, 13, 155, 66, , 
2110 za=1
2110 zb=1
2110 print "游戏帮助", 
2110 locate 10, 2
2110 print "", 
2110 box 88, 16, 152, 31, 1, 2
2110 gosub 2090
2120 k=[2](inkey$)
2130 if (k = 20) then
	zb=(zb - 1)
	if (zb = 0) then
		zb=3
	endif
endif
2140 if (k = 21) then
	zb=(zb + 1)
	if (zb = 4) then
		zb=1
	endif
endif
2150 if (k = 13) then
	on zb goto 2190, 2200, 2280, 
endif
2155 if (k = 27) then
	cls
	locate 5, 3
	print "感谢使用", 
	gosub 2090
	end
endif
2160 box 88, (za * 16), 152, ((za * 16) + 15), 1, 2
2160 locate 10, (za + 1)
2160 print "  ", 
2170 box 88, (zb * 16), 152, ((zb * 16) + 15), 1, 2
2170 locate 10, (zb + 1)
2170 print "", 
2180 za=zb
2180 goto 2120
2190 goto 10
2200 cls
2200 locate 3, 2
2200 print "程序:zhaofeixxx", 
2200 locate 3, 3
2200 print "美工：赵  飞", 
2210 locate 3, 4
2210 print "测试：刘晓斌", 
2210 gosub 2090
2210 box 1, 0, 159, 79, 1, 2
2210 k$=inkey$
2210 cls
2220 locate 2, 2
2220 print "本作品所有权归zhao", 
2220 locate 2, 3
2220 print "feixxx所有，任何人", 
2230 locate 2, 4
2230 print "不得用于商业用途。", 
2230 gosub 2090
2230 box 1, 0, 159, 79, 1, 2
2230 k$=inkey$
2230 cls
2240 locate 2, 2
2240 print "如有问题或建议请联", 
2240 locate 2, 3
2240 print "系我:", 
2240 locate 2, 4
2250 print "Email:zhaofeixxx@s", 
2250 gosub 2090
2250 box 1, 0, 159, 79, 1, 2
2250 k$=inkey$
2250 cls
2260 locate 2, 2
2260 print "ina.com", 
2260 locate 2, 3
2260 print "非常感谢您的使用与", 
2260 locate 2, 4
2270 print "合作", 
2270 gosub 2090
2270 box 1, 0, 159, 79, 1, 2
2270 k$=inkey$
2270 cls
2270 goto 2100
2280 cls
2280 locate 2, 2
2280 print "[", 
2280 locate 2, 3
2281 print "输入] 控制", 
2281 locate 2, 4
2281 print "玩家", 
2281 gosub 2090
2281 k$=inkey$
2281 cls
2290 
2291 
2300 
2301 goto 2100
9000 
9010 locate 2, 3
9020 print "古堡", 
9030 box 13, 37, 57, 43, 1, 0
9030 box 32, 18, 38, 62, 1, 0
9040 return
